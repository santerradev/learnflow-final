<!-- Sidebar do Aluno -->
<aside 
    id="sidebar" 
    class="sidebar-expanded fixed left-0 top-0 h-screen bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 z-50 transition-all duration-300"
>
    <div class="flex flex-col h-full">
        <!-- Logo -->
        <div class="p-4 border-b border-gray-200 dark:border-gray-700">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-teal-500 rounded-lg flex items-center justify-center flex-shrink-0">
                    <span class="text-white text-xl font-bold">L</span>
                </div>
                <span class="sidebar-text text-xl font-bold text-gray-800 dark:text-white whitespace-nowrap">LearnFlow</span>
            </div>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 overflow-y-auto py-4 px-2">
            <!-- PRINCIPAL -->
            <div class="mb-6">
                <h3 class="sidebar-text px-3 mb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                    Principal
                </h3>
                <ul class="space-y-1">
                    <li>
                        <a href="/cursos" class="sidebar-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 hover:bg-teal-50 dark:hover:bg-gray-700 hover:text-teal-600 dark:hover:text-teal-400 rounded-lg transition-colors">
                            <i class="fas fa-home text-lg w-6"></i>
                            <span class="sidebar-text ml-3">Início</span>
                        </a>
                    </li>
                    <li>
                        <a href="/meus-cursos" class="sidebar-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 hover:bg-teal-50 dark:hover:bg-gray-700 hover:text-teal-600 dark:hover:text-teal-400 rounded-lg transition-colors">
                            <i class="fas fa-graduation-cap text-lg w-6"></i>
                            <span class="sidebar-text ml-3">Meus Cursos</span>
                        </a>
                    </li>
                    <li>
                        <a href="/atividades" class="sidebar-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 hover:bg-teal-50 dark:hover:bg-gray-700 hover:text-teal-600 dark:hover:text-teal-400 rounded-lg transition-colors">
                            <i class="fas fa-clipboard-list text-lg w-6"></i>
                            <span class="sidebar-text ml-3">Atividades</span>
                        </a>
                    </li>
                    <li>
                        <a href="/materiais" class="sidebar-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 hover:bg-teal-50 dark:hover:bg-gray-700 hover:text-teal-600 dark:hover:text-teal-400 rounded-lg transition-colors">
                            <i class="fas fa-folder text-lg w-6"></i>
                            <span class="sidebar-text ml-3">Materiais</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- CONTA -->
            <div class="mb-6">
                <h3 class="sidebar-text px-3 mb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                    Conta
                </h3>
                <ul class="space-y-1">
                    <li>
                        <a href="/perfil" class="sidebar-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 hover:bg-teal-50 dark:hover:bg-gray-700 hover:text-teal-600 dark:hover:text-teal-400 rounded-lg transition-colors">
                            <i class="fas fa-user text-lg w-6"></i>
                            <span class="sidebar-text ml-3">Perfil</span>
                        </a>
                    </li>
                    <li>
                        <a href="/notificacoes" class="sidebar-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 hover:bg-teal-50 dark:hover:bg-gray-700 hover:text-teal-600 dark:hover:text-teal-400 rounded-lg transition-colors">
                            <i class="fas fa-bell text-lg w-6"></i>
                            <span class="sidebar-text ml-3">Notificações</span>
                            <% if (typeof notificacoesNaoLidas !== 'undefined' && notificacoesNaoLidas > 0) { %>
                                <span class="sidebar-text ml-auto bg-red-500 text-white text-xs rounded-full px-2 py-0.5">
                                    <%= notificacoesNaoLidas %>
                                </span>
                            <% } %>
                        </a>
                    </li>
                    <li>
                        <a href="/configuracoes" class="sidebar-item flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 hover:bg-teal-50 dark:hover:bg-gray-700 hover:text-teal-600 dark:hover:text-teal-400 rounded-lg transition-colors">
                            <i class="fas fa-cog text-lg w-6"></i>
                            <span class="sidebar-text ml-3">Configurações</span>
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

        <!-- User Card -->
        <div class="border-t border-gray-200 dark:border-gray-700 p-4">
            <% if (typeof user !== 'undefined' && user) { %>
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 rounded-full bg-teal-500 flex items-center justify-center text-white font-bold flex-shrink-0">
                        <%= user.nome.charAt(0).toUpperCase() %>
                    </div>
                    <div class="sidebar-text flex-1 min-w-0">
                        <p class="text-sm font-medium text-gray-900 dark:text-white truncate">
                            <%= user.nome %>
                        </p>
                        <p class="text-xs text-gray-500 dark:text-gray-400 truncate">
                            <%= user.email %>
                        </p>
                    </div>
                </div>
            <% } %>
        </div>
    </div>
</aside>

<!-- Overlay para mobile -->
<div 
    id="sidebarOverlay" 
    class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden lg:hidden"
    onclick="toggleMobileSidebar()"
></div>

<style>
    /* Sidebar States */
    .sidebar-expanded {
        width: 16rem; /* 256px */
    }
    
    .sidebar-collapsed {
        width: 5rem; /* 80px */
    }
    
    .sidebar-collapsed .sidebar-text {
        display: none;
    }
    
    .sidebar-collapsed .sidebar-item {
        justify-content: center;
    }
    
    /* Mobile */
    @media (max-width: 1024px) {
        #sidebar {
            transform: translateX(-100%);
        }
        
        #sidebar.mobile-open {
            transform: translateX(0);
        }
    }
</style>

<script>
    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        const isCollapsed = sidebar.classList.contains('sidebar-collapsed');
        
        if (isCollapsed) {
            sidebar.classList.remove('sidebar-collapsed');
            sidebar.classList.add('sidebar-expanded');
            localStorage.setItem('sidebarState', 'expanded');
        } else {
            sidebar.classList.remove('sidebar-expanded');
            sidebar.classList.add('sidebar-collapsed');
            localStorage.setItem('sidebarState', 'collapsed');
        }
        
        // Ajustar margem do conteúdo principal
        adjustMainContent();
    }
    
    function toggleMobileSidebar() {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebarOverlay');
        
        sidebar.classList.toggle('mobile-open');
        overlay.classList.toggle('hidden');
    }
    
    function adjustMainContent() {
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('mainContent');
        
        if (mainContent) {
            if (sidebar.classList.contains('sidebar-collapsed')) {
                mainContent.style.marginLeft = '5rem';
            } else {
                mainContent.style.marginLeft = '16rem';
            }
        }
    }
    
    // Restaurar estado da sidebar ao carregar
    window.addEventListener('DOMContentLoaded', function() {
        const sidebarState = localStorage.getItem('sidebarState') || 'expanded';
        const sidebar = document.getElementById('sidebar');
        
        if (sidebarState === 'collapsed') {
            sidebar.classList.remove('sidebar-expanded');
            sidebar.classList.add('sidebar-collapsed');
        }
        
        adjustMainContent();
    });
</script>